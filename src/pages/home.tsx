
import { useEffect, useState } from "react";
import InfoGrid from "../components/InfoGrid";
import WhiteRankingList from "../components/WhiteRankingList";
import BlackRankingList from "../components/BlackRankingList";
import SecretDetail from "../components/SecretDetail";
import R4 from "../assets/Rectangle 4.svg";
import R5 from "../assets/Rectangle 5.svg";
import R6 from "../assets/Rectangle 6.svg";
import R7 from "../assets/Rectangle 7.svg";

function Home() {
  const [isLoggedIn, setIsLoggedIn] = useState(false);
  const [nickname, setNickname] = useState("");
  const [ratio, setRatio] = useState(0); // 비율 값
  const [selectedPostId, setSelectedPostId] = useState<number | null>(null); // 선택된 게시글 ID

  const posts: Record<number, { title: string; date: string; body: string; image: string }> = {
    1: {
      title: `냉장고 파먹기! \n 남은 야식 처리법 5가지 추천`,
      date: "2025.01.11",
      body: `남은 야식을 처리하는 것은 냉장고 속 음식을 낭비하지 않고 활용하는 현명한 방법입니다. 오늘은 간단하면서도 맛있는 남은 야식 활용법 5가지를 소개하겠습니다.

남은 치킨으로 만드는 치킨마요 덮밥 남은 치킨을 활용해 간단하고 든든한 치킨마요 덮밥을 만들어보세요.

먼저 치킨을 한입 크기로 잘게 찢은 뒤, 팬에 살짝 데워 따뜻하게 만듭니다. 밥 위에 치킨을 올리고 달걀 프라이를 곁들입니다. 그 위에 간장, 마요네즈, 참기름을 적당히 뿌려주세요. 취향에 따라 약간의 고추장이나 깨소금을 추가해도 좋습니다. 치킨의 바삭함과 달걀의 부드러움이 어우러져 간단하지만 훌륭한 한 끼 식사가 완성됩니다. 남은 치킨이 많다면 치킨마요를 한 번 더 쌓아 층을 만들어 보는 것도 재미있습니다.

피자 조각으로 만드는 피자 토스트 식어버린 피자 조각을 더 맛있게 즐길 수 있는 방법입니다.

먼저 피자 조각을 토스터기나 프라이팬에서 바삭하게 데워줍니다. 피자 위에 남은 치즈나 모짜렐라 치즈를 추가로 올려 녹아내리도록 하면 더욱 고소한 맛을 느낄 수 있습니다. 빵 부분은 바삭하게, 토핑은 촉촉하게 만들어집니다. 취향에 따라 슬라이스된 토마토나 베이컨을 얹어 더 풍성한 맛을 낼 수도 있습니다. 이 방법은 간단하지만 기존 피자와는 또 다른 매력을 선사합니다.

남은 떡볶이로 만드는 떡볶이 볶음밥 떡볶이를 새로운 요리로 변신시키는 떡볶이 볶음밥!

먼저 남은 떡볶이 속 떡과 어묵을 한입 크기로 자릅니다. 팬에 기름을 두르고 잘게 자른 떡볶이를 볶다가 밥을 넣어 함께 볶아줍니다. 떡볶이 양념이 밥에 골고루 스며들게 잘 섞어줍니다. 필요에 따라 김가루, 참기름, 대파를 추가하면 풍미가 더욱 살아납니다. 약간 매콤하게 만들고 싶다면 고춧가루나 청양고추를 더해도 좋습니다. 떡볶이의 매콤달콤한 맛이 밥과 어우러져 완벽한 볶음밥이 탄생합니다.

감자튀김으로 만드는 감자전 바삭했던 감자튀김이 식었다고 버리지 마세요.

감자튀김을 새로운 요리로 변신시킬 수 있습니다. 남은 감자튀김을 포크나 주걱으로 으깬 뒤 부침가루와 물을 섞어 반죽을 만듭니다. 여기에 다진 양파나 피자 치즈를 넣으면 더욱 고소한 맛을 낼 수 있습니다. 반죽을 팬에 얇게 펴서 노릇노릇하게 부쳐줍니다. 간장이나 초간장 소스를 곁들이면 감자전의 맛을 한층 끌어올릴 수 있습니다. 감자튀김의 독특한 풍미와 부드러운 식감이 어우러져 새로운 별미가 완성됩니다.

남은 튀김으로 만드는 어묵탕 스타일 국물요리 튀김을 활용한 국물요리는 간단하면서도 든든한 한 끼로 적합합니다.

남은 튀김을 한입 크기로 잘라 준비합니다. 냄비에 물을 넣고 어묵탕 양념(간장, 다진 마늘, 대파, 후추)을 넣어 국물을 끓입니다. 끓는 국물에 남은 튀김을 넣고 몇 분간 끓여주면 맛있는 어묵탕 스타일의 국물요리가 완성됩니다. 여기에 떡이나 우동 면을 추가하면 더욱 든든한 요리가 됩니다. 튀김이 국물을 흡수하면서 새로운 풍미를 만들어내어 색다른 맛을 경험할 수 있습니다.

이처럼 남은 야식을 활용하면 음식물 낭비를 줄이고, 냉장고 속 자투리 음식을 색다른 요리로 변신시킬 수 있습니다. 오늘 소개한 레시피를 참고해 냉장고 속 남은 음식을 맛있게 재탄생시켜 보세요!`,
      image: R4,
    },
    2: {
      title: "서울 시내 \n 24시간 심야 식당 소개 3선",
      date: "2025.01.11",
      body: `서울은 잠들지 않는 도시로, 늦은 밤에도 맛있는 음식을 즐길 수 있는 곳이 많습니다. 오늘은 그중에서도 24시간 운영하며 심야 미식을 책임지는 서울의 대표적인 식당 3곳을 소개하겠습니다.

이태원의 "미스터 쿡스" 

  든든한 브런치와 다국적 메뉴 이태원 중심가에 위치한 "미스터 쿡스"는 24시간 운영하며 세계 각국의 다양한 음식을 제공합니다. 이곳에서는 햄버거, 파스타, 스테이크와 같은 서양식 요리는 물론, 태국식 팟타이와 일본식 라멘도 즐길 수 있습니다. 특히 심야 시간대에는 든든한 브런치 메뉴가 인기인데, 신선한 재료로 만든 에그 베네딕트와 아보카도 토스트가 입맛을 사로잡습니다. 트렌디한 인테리어와 넓은 좌석 공간도 이곳의 매력 포인트로, 친구들과 오랜 시간 이야기를 나누기 좋은 분위기를 제공합니다.

종로의 "서울 순대타운" 

  따뜻한 국밥과 전통의 맛 서울 순대타운은 심야 시간에도 한식을 찾는 사람들에게 안성맞춤인 장소입니다. 특히 24시간 운영하는 몇몇 가게는 깊은 맛의 순댓국과 감칠맛 나는 순대볶음으로 유명합니다. 뜨끈한 국밥 한 그릇에 밥을 말아 든든하게 먹으면 추운 밤도 거뜬히 버틸 수 있습니다. 순대타운의 매력은 맛뿐만 아니라, 전통적인 분위기 속에서 한식을 즐길 수 있다는 점입니다. 가족 단위나 혼자 방문하는 손님들 모두 편안히 즐길 수 있는 이곳은 서울의 야식 문화의 정수를 보여줍니다.

홍대의 "올빼미 라멘" 

  매운 라멘과 깊은 국물의 조화 홍대 골목 안쪽에 위치한 "올빼미 라멘"은 이름 그대로 심야 시간대를 위해 태어난 라멘 전문점입니다. 이곳은 매운맛 라멘이 특히 유명하며, 다섯 단계의 매운맛 중 원하는 수준을 선택할 수 있습니다. 진하고 고소한 국물은 깊은 풍미를 자랑하며, 매운맛과 조화를 이루는 부드러운 차슈와 반숙 계란이 일품입니다. 심야 시간에 속을 따뜻하게 데워줄 음식이 필요한 사람들에게 최고의 선택입니다. 깔끔한 인테리어와 빠른 서비스도 심야 식사를 더욱 편안하게 만들어줍니다.

  서울의 심야 식당들은 각기 다른 매력으로 다양한 취향을 만족시킵니다. 오늘 소개한 3곳은 늦은 시간에도 활기찬 서울을 경험할 수 있는 대표적인 장소들입니다. 다음 심야 식사 때는 이곳들에 방문해 특별한 밤을 만끽해보세요!`,
      image: R5,
    },
    3: {
      title: "늦은 밤 부담없이 즐기는\n 대파 방울토마토 구이 레시피",
      date: "2025.01.11",
      body: `늦은 밤 가볍게 즐길 수 있는 간단한 야식이 필요하다면, 대파와 방울토마토를 활용한 구이를 추천드립니다. 준비도 간단하고 맛과 건강까지 챙길 수 있는 이 레시피는 소박하지만 특별한 매력을 선사합니다. 지금부터 대파 방울토마토 구이를 만드는 방법을 소개하겠습니다.

필요한 재료 이 레시피의 매력은 소량의 재료로도 훌륭한 맛을 낼 수 있다는 점입니다. 

      준비물
대파: 2~3대
방울토마토: 10~15개
올리브 오일: 2큰술
소금과 후추: 약간
허브(선택 사항): 바질이나 로즈마리
발사믹 식초(선택 사항): 1큰술
다진 마늘(선택 사항): 1작은술


간단한 준비 과정

  대파는 깨끗이 씻어 흙을 제거한 뒤 4~5cm 길이로 썰어줍니다. 너무 얇게 자르면 볶는 과정에서 쉽게 부서질 수 있으니 적당한 크기로 자르는 것이 중요합니다. 대파를 자르기 전, 밑부분의 하얀 부분을 살짝 칼집 내어 열이 잘 통하도록 하면 요리 시간이 단축됩니다.

  방울토마토는 꼭지를 제거하고 반으로 잘라 준비합니다. 반으로 자르면 익는 시간이 단축되고 안쪽의 즙이 요리 중에 자연스럽게 나와 맛을 더할 수 있습니다. 방울토마토는 크기가 고르지 않다면 자르지 않고 사용해도 좋습니다.

  모든 재료가 준비되었으면 팬에 올리브 오일을 두르고 중불로 예열합니다.


요리 과정

1단계
  대파 굽기 예열된 팬에 대파를 먼저 넣고 볶아줍니다. 대파가 팬에 닿으면서 기름을 흡수하며 단맛이 나오기 시작합니다. 대파의 겉이 살짝 노릇해지고 부드러워질 때까지 약 2~3분간 천천히 저어줍니다. 대파가 너무 빨리 타지 않도록 불 조절에 유의하세요. 다진 마늘을 사용할 경우, 이 단계에서 대파와 함께 넣어 향을 더해줍니다.

2단계
  방울토마토 추가 대파가 적당히 익으면 방울토마토를 추가합니다. 토마토는 중불에서 조리하며 가끔씩 팬을 흔들어가며 고르게 익도록 합니다. 방울토마토가 부드러워지고 껍질이 약간 갈라지기 시작하면 잘 익은 상태입니다. 토마토 즙이 팬에 자연스럽게 배어나와 대파와 어우러지도록 살짝 눌러가며 조리하면 더욱 풍부한 맛을 느낄 수 있습니다.

3단계
  간 맞추기 토마토와 대파가 모두 익으면 소금과 후추로 간을 합니다. 간을 맞춘 뒤 팬의 내용물을 살짝 저어주어 간이 고르게 배이도록 합니다. 허브를 사용할 경우, 이 단계에서 바질이나 로즈마리를 약간 뿌려 풍미를 더할 수 있습니다. 허브가 없더라도 말린 허브가루를 약간 뿌리면 비슷한 효과를 얻을 수 있습니다.

4단계
  마무리하기 요리가 거의 완성되면 발사믹 식초를 한 큰술 정도 살짝 둘러줍니다. 발사믹 식초는 토마토의 자연스러운 단맛과 어우러지며 상큼함을 더해줍니다. 발사믹 식초를 넣은 후 1분 정도만 더 볶아 마무리합니다. 팬 바닥에 남은 국물은 빵을 찍어 먹기에 완벽한 소스 역할을 합니다.


마무리와 즐기는 방법

  팬에서 구워진 대파와 방울토마토를 접시에 옮겨 담습니다. 바로 뜨겁게 먹으면 재료의 신선한 맛을 그대로 즐길 수 있으며, 식혀서 샐러드처럼 먹어도 훌륭합니다. 구운 요리에 약간의 치즈를 갈아 뿌려도 풍미를 더할 수 있습니다.

  크래커나 바게트와 함께 곁들여 간단한 와인 안주로 활용하거나, 오믈렛 위에 얹어 메인 요리로도 변신시킬 수 있습니다. 추가로 아보카도 슬라이스를 곁들인다면 영양과 맛 모두를 업그레이드할 수 있습니다.


  대파와 방울토마토 구이는 가볍고 부담 없는 야식으로 제격입니다. 자연 그대로의 재료가 가진 맛을 최대한 살린 이 레시피는 늦은 밤에도 속을 편안하게 해줍니다. 오늘 밤에는 이 간단한 구이를 만들어 보며 건강하고 맛있는 야식 시간을 즐겨보세요!`,
      image: R6,
    },
    4: {
      title: "역류성 식도염을 부르는 야식, 예방법은?",
      date: "2025.01.11",
      body: `야식을 즐기는 사람들에게 흔히 나타날 수 있는 문제 중 하나가 바로 역류성 식도염입니다. 특히 자극적인 음식이나 잘못된 식습관이 원인이 되어 밤사이 속쓰림과 불편함을 초래할 수 있습니다. 이번 글에서는 역류성 식도염을 유발하는 야식의 종류와 이를 예방하는 방법에 대해 알아보겠습니다.


역류성 식도염을 부르는 야식의 종류

기름진 음식
  피자, 치킨, 튀김류 등은 지방 함량이 높아 소화가 더디고, 위산 분비를 자극하여 역류를 유발할 수 있습니다.

매운 음식
  떡볶이나 매운 라면처럼 캡사이신이 함유된 음식은 식도 점막을 자극하여 불편함을 초래할 수 있습니다.

초콜릿과 카페인 음료
  초콜릿은 식도 하부 괄약근을 이완시켜 위산 역류를 쉽게 일으키며, 카페인도 비슷한 영향을 미칩니다.

탄산음료
  탄산은 위에 가스를 축적시켜 압력을 증가시키고, 이는 위산이 식도로 올라오게 만드는 원인이 됩니다.

시트러스 과일
  오렌지, 자몽 등의 산도가 높은 과일은 위산 분비를 촉진하여 역류를 악화시킬 수 있습니다.


역류성 식도염 예방을 위한 야식 관리 방법

가벼운 음식 선택
  배가 고프다면 바나나, 오트밀, 삶은 달걀처럼 소화가 잘되고 위에 부담을 주지 않는 음식을 선택하세요. 이는 위산 분비를 최소화하며 밤에도 편안한 소화를 돕습니다.

야식 시간 조정
  취침 2~3시간 전에는 음식을 섭취하지 않는 것이 좋습니다. 음식물이 위에서 소화될 시간을 충분히 주어 역류 가능성을 줄일 수 있습니다.

식사량 줄이기
  밤에 과식하면 위가 팽창하여 식도로 위산이 역류할 가능성이 커집니다. 적당한 양을 유지하세요.

올바른 자세 유지
  식사 후 바로 눕지 말고, 몸을 살짝 세워 앉아 있거나 상체를 약간 높인 상태로 쉬면 위산이 올라오는 것을 방지할 수 있습니다.

자극적인 음식 피하기
  위산 분비를 유발할 수 있는 매운 음식, 기름진 음식, 탄산음료는 밤에는 피하는 것이 좋습니다.


생활 습관 개선으로 식도염 예방하기

규칙적인 식사 시간 유지
  불규칙한 식사는 역류성 식도염의 주요 원인이 될 수 있습니다. 하루 세끼를 정해진 시간에 섭취하는 습관을 들이세요.

적정 체중 유지
  과체중은 복부 압력을 증가시켜 위산 역류를 유발할 수 있습니다. 꾸준한 운동과 균형 잡힌 식단으로 체중을 관리하세요.

금연 및 절주
  흡연과 과도한 음주는 식도 하부 괄약근의 기능을 약화시켜 역류를 촉진할 수 있습니다.

수면 자세 조정
  머리와 상체를 높게 유지하며 자는 것이 역류를 예방하는 데 효과적입니다. 침대 헤드를 약간 높이는 것도 좋은 방법입니다.


  야식을 즐기는 것은 많은 사람들에게 작은 행복일 수 있지만, 잘못된 선택은 역류성 식도염이라는 큰 불편함으로 돌아올 수 있습니다. 위에서 소개한 예방 방법을 실천하여 건강한 야식 습관을 유지하고, 속 편한 밤을 보내세요.
`,
      image: R7,
    },
  };

  useEffect(() => {
    const fetchUserInfo = async () => {
      try {
        const response = await fetch("/api/user");
        if (response.ok) {
          const data = await response.json();
          setIsLoggedIn(true);
          setNickname(data.nickname);
          setRatio(data.ratio);
        } else {
          setIsLoggedIn(false);
        }
      } catch (error) {
        console.error("Error fetching user info:", error);
        setIsLoggedIn(false);
      }
    };

    fetchUserInfo();
  }, []);

  const getGourmetRank = (ratio: number): number => {
    if (ratio <= 20) return 1;
    if (ratio <= 40) return 2;
    if (ratio <= 60) return 3;
    if (ratio <= 80) return 4;
    return 5;
  };

  const gourmetRank = getGourmetRank(ratio);

  const handlePostClick = (id: number) => {
    setSelectedPostId(id);
  };

  const handleBack = () => {
    setSelectedPostId(null);
  };

  return (
    <div className="flex flex-col h-screen overflow-hidden">
      <main className="bg-white flex-1 overflow-auto p-4 space-y-6 pb-20">
        {selectedPostId ? (
          <SecretDetail
            title={posts[selectedPostId].title}
            date={posts[selectedPostId].date}
            body={posts[selectedPostId].body}
            image={posts[selectedPostId].image}
            onBack={handleBack}
          />
        ) : (
          <>
            <section className="flex justify-center items-center">
              {isLoggedIn ? (
                <span className="text-xl font-hsBombaram text-gray-700">
                  {gourmetRank}등 미식가, {nickname}님
                </span>
              ) : (
                <div className="w-full max-w-max-size">
                  <button
                    className="bg-yellow1 font-pretendard text-black w-full px-4 py-3 my-2 rounded-md flex items-center justify-center text-md"
                    onClick={() => (window.location.href = "/login")}
                  >
                    <img
                      src="/src/assets/Kakao.svg"
                      alt="카카오"
                      className="w-5 h-5 mr-2"
                    />
                    카카오로 로그인하기
                  </button>
                </div>
              )}
            </section>

            <section>
              <WhiteRankingList />
            </section>

            <section>
              <BlackRankingList />
            </section>

            <section >
              <h2 className="text-[28px] font-hsBombaram mb-0 pt-7">흑백 야식가를 위한</h2>
              <h2 className="text-[28px] font-hsBombaram mb-4">시크릿 야식 정보!</h2>
              <InfoGrid onPostClick={handlePostClick} />
            </section>
          </>
        )}
      </main>
    </div>
  );
}

export default Home;
